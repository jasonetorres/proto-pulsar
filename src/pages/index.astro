---
import {getRecipes} from '../utils/db';
import type {Recipe} from '../utils/db';
import Layout from '../layouts/Layout.astro';

const recipes: Recipe[] = await getRecipes();

// Function to handle search
// const searchRecipes = async (event: Event) => {
//     event.preventDefault();
//     const target = event.target as HTMLFormElement;
//     const searchTerm = (target.elements.namedItem('search') as HTMLInputElement).value;
//     recipes = await collection.find({ title: { $regex: searchTerm, $options: 'i' } });
// };
---

<Layout>
  <div class="card">
    <h1>Search for Christmas Cookie Recipes</h1>
      <!-- <form onsubmit={searchRecipes}>
        <input type="text" name="search" placeholder="Enter recipe name..." required />
        <button type="submit">Search</button>
      </form> -->
      <div>
        {recipes.length > 0 ? (
          <ul>
            {recipes.map(recipe => (
              <>
                <li>{recipe.description}</li>
                <p>Ingredients:</p>
                <ul class="list-disc">
                  {recipe.ingredients.map(ingredient => (
                    <li>{ingredient}</li>
                  ))}
                </ul>
                <p>Directions:</p>
                <ul class="list-decimal">
                  {recipe.instructions.map(step => (
                    <li>{step}</li>
                  ))}
                </ul>
              </>
            ))}
          </ul>
        ) : (
          <p>No recipes found.</p>
        )}
      </div>
    </div>
</Layout>

<style>
  ul {
    @apply ml-8;
  }
</style>
